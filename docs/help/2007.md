# Свойства и функции колонки табличного вопроса

Получить доступ к колонкам табличного вопроса можно через объект *columns*, например *Q.columns[5]*. Колонка содержит код, текст и флаги, но также предоставляет набор различных свойств и функций.

## `code`

Код колонки (варианта ответа внутри строки), заданный при создании в редакторе анкеты. Например:

```js
if (Q.columns[5].code != 5) {
    // странно...
}
```

## `text`

Текст колонки (варианта ответа в строке), заданный при создании в редакторе анкеты. Также позволяет изменить этот текст. Примеры:

```js
variables['Ответ 5'] = Q.columns[5].text;
Q.columns[5].text = Q2.getChecked()[0].openValueTxt;
```

## `flags`

Флаги, изменяющие различные свойства колонки табличного вопроса. Представляет собой битовую маску. Подробнее в описании свойства *flags* у [варианта ответа](2003.md#flags). Например:

```js
// Добавить колонке 5 числовое поле и разрешить его не заполнять
Q.columns[5].flags |= 0x0001 | 0x2000;
// То же самое:
Q.columns[5].flags |= AnswerFlags.OpenValueNum | AnswerFlags.AllowEmptyOpenValue;
// Если у колонки 98 есть текстовое поле...
if (Q.columns[98].flags & AnswerFlags.OpenValueTxt) {
    // ... что-то сделать
}
```

## `visible`

Возвращает *true*, если колонка отображается. Также может использоваться для принудительного скрытия или показа колонок (вариантов ответа) в табличном вопросе. Например:

```js
Q.columns[1].visible = false;
```

## `width`

Позволяет задать необходимую ширину колонки. Значение можно указать в процентах (например 40%), либо в пикселях (например 300px). Также можно указать значение *auto*, тогда ширина колонки будет автоматически рассчитана браузером. Примеры:

```js
Q.columns[1].width = '20%';
Q.columns[2].width = 'auto';
Q.columns[3].width = '150px';
```

## `exportCodeOverride`

Переопределение кода колонки (варианта ответа), используемого при выгрузке итогового массива. Подробнее [тут](1004.md#_4).

## `outputColumnTemplate`

Шаблон имени переменной для колонки (варианта ответа), при выгрузке массива. Подробнее [тут](1004.md#_4).

## `outputColumnTemplateOVN`

Шаблон имени переменной для числового открытого значения для колонки (варианта ответа). Подробнее [тут](1004.md#_4).

## `outputColumnTemplateOVT`

Шаблон имени переменной для текстового открытого значения для колонки (варианта ответа). Подробнее [тут](1004.md#_4).

## `show()`

Делает колонку видимой. Равносильно присваиванию *true* свойству [visible](#visible). Например:

```js
Q.columns[5].show();
```

## `hide()`

Скрывает колонку. Равносильно присваиванию *false* свойству [visible](#visible). Например:

```js
Q.columns[5].hide();
```

## `image`

Содержит изображение колонки (варианта ответа), а также позволяет добавить колонке изображение из объекта [images](2001.md#images). Примеры:

```js
Q.columns[5].image = Q34.columns[5].image;
Q.columns[5].image = images['Логотип'];
```

## `imageUrl`

Содержит URL изображения, а также позволяет добавить колонке (варианту ответа) изображение с внешнего сервера по прямой ссылке. Приоритет этого свойства выше свойства *image*, то есть если они заданы оба, то выполнится только *imageUrl*. Пример:

if (!Q.columns[5].imageUrl.length) {
    Q.columns[5].imageUrl = 'https://www.survey-studio.com/content/images/ss2_logo_74x74.png';
}

## `imagePlacement`

Содержит код расположения изображения относительно текста, а также позволяет задать расположение картинки. Более подробную информацию можно найти [здесь](2002.md#imageplacement). Примеры:

```js
Q.columns[5].imageUrl = 'https://www.survey-studio.com/content/images/ss2_logo_74x74.png';
Q.columns[5].imagePlacement = 4;
// или
Q.columns[5].imagePlacement = ImagePlacementIds.Right;
```
